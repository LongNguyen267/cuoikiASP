@model GameStore.ViewModels.ProductDetailsViewModel

@{
    ViewData["Title"] = "Chi tiết sản phẩm";
    var product = Model.MainProduct;
}

@section Styles {
    <link rel="stylesheet" href="~/css/Detail.css" asp-append-version="true" />
}

@if (product != null)
{
    <div class="container py-5">
        <div class="product-details-container row">
            <div class="col-md-6 product-image-box">
                @if (!string.IsNullOrEmpty(product.ImageUrl))
                {
                    <img src="@product.ImageUrl" alt="@product.Name" class="product-image img-fluid" />
                }
                else
                {
                    <img src="https://via.placeholder.com/400x400?text=No+Image" alt="No Image" class="product-image img-fluid" />
                }
            </div>

            <div class="col-md-6 product-info d-flex flex-column justify-content-center">
                <h1 class="product-name">@product.Name</h1>
                <p class="text-muted">SKU: @product.Sku</p>

                <h2 class="product-price">@product.Price.ToString("N0")đ</h2>

                <p class="fs-5">
                    <span>Tồn kho:</span>
                    <span class="@(product.StockQuantity > 0 ? "text-success" : "text-danger") fw-bold">
                        @(product.StockQuantity > 0 ? $"{product.StockQuantity}" : "Hết hàng")
                    </span>
                </p>

                <p class="product-description">@product.Description</p>

                <div class="d-flex gap-3 mt-4">
                    <form asp-controller="Cart" asp-action="AddToCart" method="post">
                        <input type="hidden" name="productId" value="@product.Id" />
                        <button type="submit" class="btn btn-primary btn-lg rounded-pill" @(product.StockQuantity <= 0 ? "disabled" : "")>
                            <i class="bi bi-cart-plus-fill me-2"></i> Thêm vào giỏ
                        </button>
                    </form>

                    <a asp-action="Index" class="btn btn-outline-secondary btn-lg rounded-pill">
                        Quay lại danh sách
                    </a>
                </div>
            </div>
        </div>
    </div>

    @if (Model.RelatedProducts.Any())
    {
        <div class="related-products-section">
            <div class="container">
                <h3 class="section-title">Sản phẩm liên quan</h3>
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
                    @foreach (var relatedProduct in Model.RelatedProducts)
                    {
                        <div class="col">
                            <div class="card h-100 shadow-sm product-card">
                                <a asp-controller="Products" asp-action="Details" asp-route-id="@relatedProduct.Id">
                                    <img src="@relatedProduct.ImageUrl" class="card-img-top" alt="@relatedProduct.Name">
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title">@relatedProduct.Name</h5>
                                        <p class="card-text fw-bold text-danger fs-6">@relatedProduct.Price.ToString("C")</p>
                                    </div>
                                </a>
                                <div class="card-footer bg-transparent border-0 d-grid">
                                    <form asp-controller="Cart" asp-action="AddToCart" method="post">
                                        <input type="hidden" name="productId" value="@relatedProduct.Id" />
                                        <button type="submit" class="btn btn-primary btn-sm w-100">Thêm vào giỏ</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    }
}
else
{
    <p>Không tìm thấy sản phẩm.</p>
}